<!DOCTYPE html>
<html lang="en">
<head>
	<meta http-equiv="content-type" content="text/html; charset=UTF-8">
	<meta charset="utf-8">
	<title>Cloud Admin | xCharts</title>
	<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1, user-scalable=no">
	<meta name="description" content="">
	<meta name="author" content="">

	<!-- STYLESHEETS --><!--[if lt IE 9]>
	<script src="js/flot/excanvas.min.js"></script><![endif]-->
	<link rel="stylesheet" type="text/css" href="css/cloud-admin.css" >
	<link rel="stylesheet" type="text/css"  href="css/themes/default.css" id="skin-switcher" >
	<link rel="stylesheet" type="text/css"  href="css/responsive.css" >
	
	<link href="font-awesome/css/font-awesome.min.css" rel="stylesheet">
	<!-- JQUERY UI-->
	<link rel="stylesheet" type="text/css" href="js/jquery-ui-1.10.3.custom/css/custom-theme/jquery-ui-1.10.3.custom.min.css" />
	<!-- DATE RANGE PICKER -->
	<link rel="stylesheet" type="text/css" href="js/bootstrap-daterangepicker/daterangepicker-bs3.css" />
	<!-- BOOTSTRAP SWITCH -->
	<link rel="stylesheet" type="text/css" href="js/bootstrap-switch/bootstrap-switch.min.css" />
	<!-- HUBSPOT MESSENGER -->
	<link rel="stylesheet" type="text/css" href="js/hubspot-messenger/css/messenger.min.css" />
	<link rel="stylesheet" type="text/css" href="js/hubspot-messenger/css/messenger-spinner.min.css" />
	<link rel="stylesheet" type="text/css" href="js/hubspot-messenger/css/messenger-theme-air.min.css" />
	<link rel="stylesheet" type="text/css" href="js/hubspot-messenger/css/messenger-theme-block.min.css" />
	<link rel="stylesheet" type="text/css" href="js/hubspot-messenger/css/messenger-theme-flat.min.css" />
	<link rel="stylesheet" type="text/css" href="js/hubspot-messenger/css/messenger-theme-future.min.css" />
	<link rel="stylesheet" type="text/css" href="js/hubspot-messenger/css/messenger-theme-ice.min.css" />
	<!-- MAGIC SUGGEST -->
	<link rel="stylesheet" type="text/css" href="js/magic-suggest/magicsuggest-1.3.1-min.css" />
	<!-- DATE PICKER -->
	<link rel="stylesheet" type="text/css" href="js/datepicker/themes/default.min.css" />
	<link rel="stylesheet" type="text/css" href="js/datepicker/themes/default.date.min.css" />
	<link rel="stylesheet" type="text/css" href="js/datepicker/themes/default.time.min.css" />
	<!-- XCHARTS -->
	<link rel="stylesheet" type="text/css" href="js/xcharts/xcharts.min.css" />
	<!-- COLOR PICKER -->
	<link rel="stylesheet" type="text/css" href="js/colorpicker/css/colorpicker.min.css" />
	
</head>
<body>

	
	<!-- PAGE -->
	<section id="page">

			<!-- /SAMPLE BOX CONFIGURATION MODAL FORM-->
			<div class="container">
				<div class="row">
					<div id="content" class="col-lg-12">
 
						<!-- DYNAMIC CHART -->
						<div class="row">
							<div class="col-md-9">
								<!-- BOX -->
								<div class="box border red">
									<div class="box-title">
										<h4><i class="fa fa-bar-chart-o"></i>Dynamic Controlled Chart</h4>
										<div class="tools hidden-xs">
											<a href="#box-config" data-toggle="modal" class="config">
												<i class="fa fa-cog"></i>
											</a>
											<a href="javascript:;" class="reload">
												<i class="fa fa-refresh"></i>
											</a>
											<a href="javascript:;" class="collapse">
												<i class="fa fa-chevron-up"></i>
											</a>
											<a href="javascript:;" class="remove">
												<i class="fa fa-times"></i>
											</a>
										</div>
									</div>
									<div class="box-body">
										<div class="row">
											<div class="col-md-3 btn-group multi">
												<button class="btn btn-default toggled" data-type="line-dotted">折线图</button>
												<button class="btn btn-default" data-type="bar">柱状图</button>
											</div>
										</div>
										<div class="divide-10"></div>
										<figure class="chart" id="chart1" style="min-width:250px"></figure>
									</div>
								</div>
								<!-- /BOX -->
							</div>
						</div>
						<!-- /DYNAMIC CHART -->

						<!-- DATE PICKER -->
						<div class="row">
							<div class="col-md-5">
								<div class="box border blue">
									<div class="box-title">
										<h4><i class="fa fa-calendar"></i>Date & Time Picker</h4>
										<div class="tools">
											<a href="#box-config" data-toggle="modal" class="config">
												<i class="fa fa-cog"></i>
											</a>
											<a href="javascript:;" class="reload">
												<i class="fa fa-refresh"></i>
											</a>
											<a href="javascript:;" class="collapse">
												<i class="fa fa-chevron-up"></i>
											</a>
											<a href="javascript:;" class="remove">
												<i class="fa fa-times"></i>
											</a>
										</div>
									</div>
									<div class="box-body">
										 <form class="form-horizontal " action="#">
											<div class="form-group">
												<label class="col-md-4 control-label">Default datepicker:</label>
												<div class="col-md-8">
													<input  class="form-control datepicker" type="text" name="regular" size="10">
												</div>
											</div>
											<div class="form-group">
												<label class="col-md-4 control-label">Fullscreen datepicker:</label>
												<div class="col-md-8">
													<input type="text" name="regular" class="form-control datepicker-fullscreen">
												</div>
											</div>
											<div class="form-group">
												<label class="col-md-4 control-label">Fullscreen timepicker:</label>
												<div class="col-md-8">
													<input type="text" name="regular" class="form-control timepicker-fullscreen">
												</div>
											</div>																			
										</form>
									</div>
								<!-- /DATE PICKER -->
							</div>
						</div>		
						
					</div><!-- /CONTENT-->
			</div></div>
		</div>

	</section>
	<!--/PAGE -->
	<!-- JAVASCRIPTS -->
	<!-- Placed at the end of the document so the pages load faster -->
	<!-- JQUERY -->
	<script src="js/jquery/jquery-2.0.3.min.js"></script>
	<!-- JQUERY UI-->
	<script src="js/jquery-ui-1.10.3.custom/js/jquery-ui-1.10.3.custom.min.js"></script>
	<!-- BOOTSTRAP -->
	<script src="bootstrap-dist/js/bootstrap.min.js"></script>
	
		
	<!-- DATE RANGE PICKER -->
	<script src="js/bootstrap-daterangepicker/moment.min.js"></script>
	
	<script src="js/bootstrap-daterangepicker/daterangepicker.min.js"></script>
	<!-- SLIMSCROLL -->
	<script type="text/javascript" src="js/jQuery-slimScroll-1.3.0/jquery.slimscroll.min.js">
	</script>
	<script type="text/javascript" src="js/jQuery-slimScroll-1.3.0/slimScrollHorizontal.min.js"></script>
	<!-- BLOCK UI -->
	<script type="text/javascript" src="js/jQuery-BlockUI/jquery.blockUI.min.js"></script>
	<!-- D3 -->
	<script type="text/javascript" src="js/d3/d3.v3.min.js"></script>
	<!-- XCHARTS -->
	<script type="text/javascript" src="js/xcharts/xcharts.min.js"></script>
	<!-- DATE PICKER -->
	<script type="text/javascript" src="js/datepicker/picker.js"></script>
	<script type="text/javascript" src="js/datepicker/picker.date.js"></script>
	<script type="text/javascript" src="js/datepicker/picker.time.js"></script>
	<!-- COOKIE -->
	<script type="text/javascript" src="js/jQuery-Cookie/jquery.cookie.min.js"></script>
	<!-- CUSTOM SCRIPT -->
	<script src="js/script.js"></script>
	<script>

		var data ;//绘制图表的数据

		jQuery(document).ready(function() {	

	        $(".datepicker").datepicker();
			$(".inlinepicker").datepicker({
				inline: true,
				showOtherMonths: true
			});
			$(".datepicker-fullscreen").pickadate();
			$(".timepicker-fullscreen").pickatime();

            chart1();

		});

		//将数据从后台取出，置入本地对象中
		function setdata(){
			$.post("./xcharts/findLeastData.action", null ,
					function(returndata, status) {
						if ("success" == status) {
							var obj = eval(returndata);
							data = obj.models;
						}
					});
		}

		//Dynamic Chart
		function chart1() {

			//向后台请求数据
			$.post("./xcharts/findLeastData.action", null ,
					function(returndata, status) {
						if ("success" == status) {

							var obj = eval(returndata);

							data = obj.models;

							var order = [0, 1, 0, 2],
									i = 0,
									xFormat = d3.time.format.utc("%Y-%m-%d %H:%M:%S"),
									chart = new xChart('line-dotted', data[order[i]], '#chart1', {
										axisPaddingTop: 5,
										dataFormatX: function (x) {
											return new Date(x);
										},
										tickFormatX: function (x) {
											return xFormat(x);
										},
										timing: 1250
									}),
									rotateTimer,
									toggles = d3.selectAll('.multi button'),
									t = 3500;

							function updateChart(i) {
								var d = data[i];
								chart.setData(d);
								toggles.classed('toggled', function () {
									return (d3.select(this).attr('data-type') === d.type);
								});
								return d;
							}

							var nowtype =0;
							toggles.on('click', function (d, i) {
								nowtype = i;//设置当前要展示哪种图形
								setdata();
								//clearTimeout(rotateTimer);
								updateChart(i);
							});

							//进行组合后达到定时刷新页面元素的效果
							function rotateChart() {
								setdata();
								updateChart(nowtype);
								rotateTimer = setTimeout(rotateChart, t);
							}

							rotateTimer = setTimeout(rotateChart, t);

						}
					});

		}

	</script>
	<!-- /JAVASCRIPTS -->
</body>
</html>